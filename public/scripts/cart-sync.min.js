!function(){const t="https://arco-henna.vercel.app";let n=null;async function e(){try{const t=await fetch("/cart.js",{method:"GET",credentials:"include",headers:{Accept:"application/json"}});if(t.ok)return await t.json()}catch(t){console.error("Error fetching Shopify AJAX cart:",t)}return null}async function a(){if(!n)return null;try{const e=await fetch(`${t}/api/cart?userId=${encodeURIComponent(n)}`,{method:"GET",headers:{Accept:"application/json"}});if(e.ok){return(await e.json()).cart||null}}catch(t){console.error("Error fetching backend cart:",t)}return null}async function r(e){if(!n)return null;try{await fetch(t+"/api/cart",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n,cartData:e||{}})})}catch(t){console.error("Error syncing local cart to backend:",t)}}async function i(){if(n="undefined"!=typeof window&&window.CUSTOMER_ID?String(window.CUSTOMER_ID):null,!n)return;const[t,r]=await Promise.all([e(),a()]);var i,o;r&&(i=t,o=r,JSON.stringify(i)!==JSON.stringify(o))&&await async function(t){try{if(await fetch("/cart/clear.js",{method:"POST",credentials:"include"}),t&&t.items&&t.items.length>0){const n=t.items.map((t=>({id:t.shopifyVariantId||t.variantId||t.variant_id,quantity:t.quantity,properties:t.properties||void 0})));await fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({items:n})})}window.location.reload()}catch(t){console.error("Error replacing cart:",t)}}(r)}document.addEventListener("DOMContentLoaded",(()=>{i(),function(){const t=window.fetch;window.fetch=function(...n){let a="string"==typeof n[0]?n[0]:n[0]?.url;return a&&a.match(/\/cart\/(add|update|change|clear)(\.js)?/)&&setTimeout((async()=>{const t=await e();await r(t)}),100),t.apply(this,n)};const n=window.XMLHttpRequest.prototype.open;window.XMLHttpRequest.prototype.open=function(t,a,...i){return this.addEventListener("load",(function(){a&&a.match(/\/cart\/(add|update|change|clear)(\.js)?/)&&setTimeout((async()=>{const t=await e();await r(t)}),100)})),n.call(this,t,a,...i)}}()}))}();